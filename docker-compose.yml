version: '3.8'

services:
  # React Frontend ONLY - testing simplified deployment
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
      args:
        VITE_API_URL: ${VITE_API_URL:-https://gpxify.carapacebleue.com}
        VITE_GOOGLE_CLIENT_ID: ${GOOGLE_CLIENT_ID:-381330006153-l2o78vsaf54tnof4ikass4ig1a8p9n94.apps.googleusercontent.com}
    container_name: gpxify-frontend
    restart: unless-stopped
    expose:
      - "80"
    labels:
      - traefik.enable=true
      - traefik.http.routers.gpxify-frontend.rule=Host(`gpxify.carapacebleue.com`)
      - traefik.http.routers.gpxify-frontend.entryPoints=http
      - traefik.http.routers.gpxify-frontend.service=gpxify-frontend
      - traefik.http.services.gpxify-frontend.loadbalancer.server.port=80
      - traefik.http.routers.gpxify-frontend-https.rule=Host(`gpxify.carapacebleue.com`)
      - traefik.http.routers.gpxify-frontend-https.entryPoints=https
      - traefik.http.routers.gpxify-frontend-https.tls=true
      - traefik.http.routers.gpxify-frontend-https.tls.certresolver=letsencrypt
      - traefik.http.routers.gpxify-frontend-https.service=gpxify-frontend
    networks:
      - coolify

networks:
  coolify:
    external: true
